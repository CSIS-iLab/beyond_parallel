!function(r){r.fn.rowGrouping=function(e){function n(){}function o(r){var e=["January","February","March","April","May","June","Jully","August","September","October","November","December"];return e[r-1]}var a={iGroupingColumnIndex:0,sGroupingColumnSortDirection:"",iGroupingOrderByColumnIndex:-1,sGroupingClass:"group",bHideGroupingColumn:!0,bHideGroupingOrderByColumn:!0,sGroupBy:"name",sGroupLabelPrefix:"",bExpandableGrouping:!1,bExpandSingleGroup:!1,iExpandGroupOffset:100,asExpandedGroups:null,sDateFormat:"dd/MM/yyyy",sEmptyGroupLabel:"-",bSetGroupingClassOnTR:!1,iGroupingColumnIndex2:-1,sGroupingColumnSortDirection2:"",iGroupingOrderByColumnIndex2:-1,sGroupingClass2:"subgroup",bHideGroupingColumn2:!0,bHideGroupingOrderByColumn2:!0,sGroupBy2:"name",sGroupLabelPrefix2:"",bExpandableGrouping2:!1,fnOnGrouped:n};return this.each(function(n,u){function s(e){return-1!=r.inArray(e,f)}function t(r){return r.substr(C,c)}function i(r){return r}function p(r){return r.substr(0,1)}function l(r){return t(r)}function d(r){return r.substr(C,c)+" "+o(r.substr(iMonthIndex,iMonthLength))}function g(r){return r.toLowerCase().replace(/\W+/g,"-")}var m=r(u).dataTable(),G=function(e){var n=r(this).attr("rel"),o=s(n);if(y.bExpandSingleGroup){if(!o){var a=f[0];f=new Array,f.push(n),r(".group-item-"+a,m).hide(),r(".group-item-"+n,m).show();var u=r(".expanded-group");if(u.removeClass("expanded-group"),u.addClass("collapsed-group"),r(this).addClass("expanded-group"),r(this).removeClass("collapsed-group"),-1!=y.iExpandGroupOffset){var t=r("#group-id-"+m.attr("id")+"-"+n).offset().top-y.iExpandGroupOffset;window.scroll(0,t)}else{var t=m.offset().top;window.scroll(0,t)}}}else if(o){var i=r.inArray(n,f);f.splice(i,1),r(this).removeClass("expanded-group"),r(this).addClass("collapsed-group"),r(".group-item-"+n,m).hide()}else f.push(n),r(this).addClass("expanded-group"),r(this).removeClass("collapsed-group"),r(".group-item-"+n,m).show();e.preventDefault()},C=6,c=4,f=new Array,x=!0,y=r.extend(a,e);if((null!=y.sGrupingClass||null!=y.sGrupingClass2)&&alert("Since the version 1.1. sGrupingClass sGrupingClass2 are renamed to sGroupingClass and sGroupingClass2. Please correct your settings"),-1==y.iGroupingOrderByColumnIndex?(y.bCustomColumnOrdering=!1,y.iGroupingOrderByColumnIndex=y.iGroupingColumnIndex):y.bCustomColumnOrdering=!0,""==y.sGroupingColumnSortDirection&&(y.sGroupingColumnSortDirection="year"==y.sGroupBy?"desc":"asc"),-1==y.iGroupingOrderByColumnIndex2?(y.bCustomColumnOrdering2=!1,y.iGroupingOrderByColumnIndex2=y.iGroupingColumnIndex2):y.bCustomColumnOrdering2=!0,""==y.sGroupingColumnSortDirection2&&(y.sGroupingColumnSortDirection2="year"==y.sGroupBy2?"desc":"asc"),null!=y.asExpandedGroups)if("NONE"==y.asExpandedGroups)y.asExpandedGroups=[],f=y.asExpandedGroups,x=!1;else if("ALL"==y.asExpandedGroups);else if(y.asExpandedGroups.constructor==String){var b=y.asExpandedGroups;y.asExpandedGroups=new Array,y.asExpandedGroups.push(g(b)),f=y.asExpandedGroups,x=!1}else if(y.asExpandedGroups.constructor==Array){for(var h=0;h<y.asExpandedGroups.length&&(f.push(g(y.asExpandedGroups[h])),!y.bExpandSingleGroup);h++);x=!1}C=y.sDateFormat.toLowerCase().indexOf("yy"),c=y.sDateFormat.toLowerCase().lastIndexOf("y")-y.sDateFormat.toLowerCase().indexOf("y")+1,iMonthIndex=y.sDateFormat.toLowerCase().indexOf("mm"),iMonthLength=y.sDateFormat.toLowerCase().lastIndexOf("m")-y.sDateFormat.toLowerCase().indexOf("m")+1;var S=i;switch(y.sGroupBy){case"letter":S=p;break;case"year":S=l;break;case"month":S=d;break;default:S=i}var O=function(e){m.fnSettings().oFeatures.bServerSide&&(x=!0);var n=!1;if(0!=e.aiDisplay.length){for(var o=r("tbody > tr",m).filter(function(){return!r(this).parent().hasClass("noGroup")}),a=r(o[0]).find(" > td").length,u=null,t=null,i=0;i<o.length;i++){var p=e._iDisplayStart+i;m.fnSettings().oFeatures.bServerSide&&(p=i);var l="",d=null,C="",c=null;try{l=this.fnGetData(o[i],y.iGroupingColumnIndex)}catch(b){}var d=l;if("year"!=y.sGroupBy&&(d=S(l)),r(o[i]).attr("data-group",g(d)),n&&(C=e.aoData[e.aiDisplay[p]]._aData[y.iGroupingColumnIndex2],void 0==C&&(C=e.aoData[e.aiDisplay[p]]._aData[e.aoColumns[y.iGroupingColumnIndex2].mDataProp]),"year"!=y.sGroupBy2&&(c=S(C)),r(o[i]).attr("data-group",g(d)+"_"+g(c))),null==u||g(d)!=g(u)){var h=g(d);y.bExpandableGrouping&&x&&(y.bExpandSingleGroup?0==f.length&&f.push(h):f.push(h));var O=document.createElement("tr"),E=document.createElement("td");O.id="group-id-"+m.attr("id")+"-"+h,y.bSetGroupingClassOnTR?O.className=y.sGroupingClass+" "+h:E.className=y.sGroupingClass+" "+h,E.colSpan=a,E.innerHTML=y.sGroupLabelPrefix+(""==d?y.sEmptyGroupLabel:d),y.bExpandableGrouping&&(E.className+=s(h)?" expanded-group":" collapsed-group",E.className+=" group-item-expander",r(E).attr("rel",h),r(E).click(G)),O.appendChild(E),o[i].parentNode.insertBefore(O,o[i]),u=d,t=null}if(y.bExpandableGrouping&&(r(o[i]).addClass("group-item-"+h),s(h)||r(o[i]).hide()),n&&(null==t||g(c)!=g(t))){var v=document.createElement("tr"),D=document.createElement("td");y.bSetGroupingClassOnTR?v.className=y.sGroupingClass2+" "+c.toLowerCase().replace(" ","-"):D.className=y.sGroupingClass2+" "+c.toLowerCase().replace(" ","-"),D.colSpan=a,D.innerHTML=y.sGroupLabelPrefix2+(""==c?y.sEmptyGroupLabel:c),v.appendChild(D),o[i].parentNode.insertBefore(v,o[i]),t=c}}y.fnOnGrouped(),x=!1}};m.fnSetColumnVis(y.iGroupingColumnIndex,!y.bHideGroupingColumn),y.bCustomColumnOrdering&&m.fnSetColumnVis(y.iGroupingOrderByColumnIndex,!y.bHideGroupingOrderByColumn),-1!=y.iGroupingColumnIndex2&&m.fnSetColumnVis(y.iGroupingColumnIndex2,!y.bHideGroupingColumn2),y.bCustomColumnOrdering2&&m.fnSetColumnVis(y.iGroupingOrderByColumnIndex2,!y.bHideGroupingOrderByColumn2),m.fnSettings().aoDrawCallback.push({fn:O,sName:"fnRowGrouping"});var E=new Array;switch(E.push([y.iGroupingOrderByColumnIndex,y.sGroupingColumnSortDirection]),-1!=y.iGroupingColumnIndex2&&E.push([y.iGroupingOrderByColumnIndex2,y.sGroupingColumnSortDirection2]),m.fnSettings().aaSortingFixed=E,y.sGroupBy){case"name":break;case"letter":m.fnSettings().aoColumns[y.iGroupingOrderByColumnIndex].sSortDataType="rg-letter",r.fn.dataTableExt.afnSortData["rg-letter"]=function(e,n){var o=[];return r("td:eq("+n+")",e.oApi._fnGetTrNodes(e)).each(function(){o.push(p(this.innerHTML))}),o};break;case"year":m.fnSettings().aoColumns[y.iGroupingOrderByColumnIndex].sSortDataType="rg-date",r.fn.dataTableExt.afnSortData["rg-date"]=function(e,n){var o=[];return r("td:eq("+n+")",e.oApi._fnGetTrNodes(e)).each(function(){o.push(t(this.innerHTML))}),o}}"name"==y.sGroupBy||"letter"==y.sGroupBy,m.fnDraw()})}}(jQuery);