google.load("visualization","1",{packages:["corechart","bar","gauge","scatter"]});var wpDataTablesGoogleChart=function(){var t={rows:[],columns:[],type:"column",containerId:"googleChartContainer",columnIndexes:[],connectedWPDataTable:null,chart:null,googleDataTable:null,renderCallback:null,options:{animation:{duration:1e3,easing:"out",startup:!0},backgroundColor:{fill:"#FFFFFF",strokeWidth:0,stroke:"#666",rx:0},chartArea:{backgroundColor:{}},crosshair:{},curveType:"none",fontName:"Arial",fontSize:null,hAxis:{direction:1},height:400,legend:{position:"right"},orientation:"horizontal",titlePosition:"out",tooltip:{trigger:"focus"},vAxis:{direction:1,viewWindow:{}}},setRows:function(t){this.rows=t},detectDates:function(){for(var t in this.columns)if("date"==this.columns[t].type)for(var e in this.rows){var a=Date.parse(this.rows[e][t]);isNaN(a)?this.rows[e][t]=new Date:this.rows[e][t]=new Date(a)}},setColumns:function(t){this.columns=t},getColumns:function(){return this.columns},setOptions:function(e){for(var a in e)"responsive_width"!=a||"1"!=e[a]?this.options[a]=e[a]:(t.options.animation=!1,jQuery(window).resize(function(){t.chart.draw(t.googleDataTable,t.options)}))},getOptions:function(){return this.options},setType:function(t){this.type=t},getType:function(){return this.type},setGrouping:function(t){this.group_chart=t},setContainer:function(t){this.containerId=t},getContainer:function(){return this.containerId},setRenderCallback:function(t){this.renderCallback=t},render:function(){this.googleDataTable=new google.visualization.DataTable;for(var t in this.columns)this.googleDataTable.addColumn(this.columns[t]);switch(this.detectDates(),this.googleDataTable.addRows(this.rows),this.type){case"google_column_chart":this.chart=new google.visualization.ColumnChart(document.getElementById(this.containerId));break;case"google_histogram":this.chart=new google.visualization.Histogram(document.getElementById(this.containerId));break;case"google_bar_chart":this.options.orientation="vertical",this.chart=new google.visualization.BarChart(document.getElementById(this.containerId));break;case"google_area_chart":this.chart=new google.visualization.AreaChart(document.getElementById(this.containerId));break;case"google_stepped_area_chart":this.options.isStacked=!0,this.chart=new google.visualization.SteppedAreaChart(document.getElementById(this.containerId));break;case"google_line_chart":this.chart=new google.visualization.LineChart(document.getElementById(this.containerId));break;case"google_pie_chart":this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_bubble_chart":this.chart=new google.visualization.BubbleChart(document.getElementById(this.containerId));break;case"google_donut_chart":this.options.pieHole=.4,this.chart=new google.visualization.PieChart(document.getElementById(this.containerId));break;case"google_gauge_chart":this.options.redFrom=90,this.options.redTo=100,this.options.yellowFrom=75,this.options.yellowTo=90,this.options.minorTicks=5,this.chart=new google.visualization.Gauge(document.getElementById(this.containerId));break;case"google_scatter_chart":this.chart=new google.visualization.ScatterChart(document.getElementById(this.containerId));break;case"google_candlestick_chart":this.chart=new google.visualization.CandlestickChart(document.getElementById(this.containerId))}null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},refresh:function(){this.googleDataTable=new google.visualization.DataTable;for(var t in this.columns)this.googleDataTable.addColumn(this.columns[t]);this.detectDates(),this.googleDataTable.addRows(this.rows),null!==this.renderCallback&&this.renderCallback(this),this.chart.draw(this.googleDataTable,this.options)},setConnectedWPDataTable:function(t){this.connectedWPDataTable=t},getConnectedWPDataTable:function(){return this.connectedWPDataTable},enableFollowFiltering:function(){null!=this.connectedWPDataTable&&this.connectedWPDataTable.fnSettings().aoDrawCallback.push({sName:"chart_filter_follow",fn:function(e){var a=[];t.options.animation=!1;var o=t.connectedWPDataTable._("tr",{filter:"applied"}).toArray(),n=jQuery.parseJSON(jQuery("#"+t.connectedWPDataTable.data("described-by")).val()).datepickFormat,i=jQuery.parseJSON(jQuery("#"+t.connectedWPDataTable.data("described-by")).val()).number_format;for(var s in o){var r=[];for(var l in t.columnIndexes)if("number"==t.columns[l].type){var c=o[s][t.columnIndexes[l]];if(isNaN(c)){if(1==i)var h=".",u=",";else var h=",",u=".";c=wdtUnformatNumber(c,h,u,!0)}r.push(parseFloat(c))}else"date"==t.columns[l].type?r.push(jQuery.datepicker.parseDate(n,o[s][t.columnIndexes[l]])):r.push(o[s][t.columnIndexes[l]]);a.push(r)}if(1==t.group_chart){var g=[];for(var s in a)if("undefined"!=typeof g&&g.length>0){var d="none";for(var l in g)"none"===d&&g[l][0]==a[s][0]&&(d=l);if("none"===d)g.push(a[s]);else for(var m in a[s])0!=m&&(g[d][m]+=a[s][m])}else g.push(a[s]);a=g}t.rows=a,t.refresh()}})},setColumnIndexes:function(t){this.columnIndexes=t},getColumnIndexes:function(){return this.columnIndexes}};return t};